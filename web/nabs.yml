# -- BUILD

build:
  $depend: []
  $action: run-p build:legacy build:local

  legacy: node scripts/build-legacy.js build
  # frontend: vite build
  local:
    - cd ../install/local/dev
    - docker-compose -p wikijump -f docker-compose.yaml -f docker-compose.dev.yaml build

# -- DEV

dev:
  $depend: []
  $action:
    - pnpm build:local
    - run-p dev:legacy dev:local

  legacy: node scripts/build-legacy.js dev
  # frontend: vite dev
  local:
    - cd ../install/local/dev
    - docker-compose -p wikijump -f docker-compose.yaml -f docker-compose.dev.yaml up

# -- DOCKER UTILITY

docker:stop:
  - cd ../install/local/dev
  - docker-compose -p wikijump -f docker-compose.yaml -f docker-compose.dev.yaml stop

docker:reset:
  - cd ../install/local/dev
  - docker-compose -p wikijump -f docker-compose.yaml -f docker-compose.dev.yaml down
